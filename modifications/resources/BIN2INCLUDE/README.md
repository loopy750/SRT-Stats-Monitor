Modified version by loopy750 to fix invalid data.
